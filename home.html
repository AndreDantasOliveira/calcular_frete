<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Frete - Sapato</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f9f9f9;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
      margin-top: 20px;
    }
    button:hover {
      background-color: #0056b3;
    }
    .resultado {
      margin-top: 20px;
      background: #eef;
      padding: 10px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Produto: Sapato</h2>

    <label for="quantidade">Quantidade:</label>
    <input type="number" id="quantidade" min="1" value="1">

    <label for="cep">Informe seu CEP:</label>
    <input type="text" id="cep" placeholder="Ex: 01001-000">

    <button onclick="calcularFrete()">Calcular Frete</button>

    <div class="resultado" id="resultadoFrete"></div>
  </div>

  <script>
    async function calcularFrete() {
      const quantidade = document.getElementById("quantidade").value;
      const cepDestino = document.getElementById("cep").value;
      const resultadoDiv = document.getElementById("resultadoFrete");

      if (!cepDestino || !quantidade) {
        resultadoDiv.innerHTML = "Preencha todos os campos corretamente.";
        return;
      }

      resultadoDiv.innerHTML = "Calculando...";

      const payload = {
        "from": "41720-020", // CEP do despachante
        "to": cepDestino,
        "products": [
          {
            "height": 12,
            "width": 20,
            "length": 30,
            "weight": 1,
            "insurance_value": 100,
            "quantity": parseInt(quantidade)
          }
        ]
      };

      try {
        const response = await fetch("https://api.superfrete.com.br/v1/quote", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NTM0Nzk3MDYsInN1YiI6Ik9QOHN1cHI2NklhY045cE9RaUxzYjZLQ1ljRzIifQ.8_VgCiD22sI20m6M_1Gzd0aK5Cgx_fZmDr1VmvCNjJg"
          },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
          throw new Error("Erro ao buscar frete.");
        }

        const data = await response.json();

        if (data.length === 0) {
          resultadoDiv.innerHTML = "Nenhuma cotação disponível para esse CEP.";
          return;
        }

        const frete = data[0]; // Usamos o primeiro resultado

        resultadoDiv.innerHTML = `
          <strong>Frete:</strong> R$ ${frete.price.toFixed(2)}<br>
          <strong>Prazo:</strong> ${frete.deadline} dias úteis<br>
          <strong>Transportadora:</strong> ${frete.carrier.name}
        `;
      } catch (error) {
        resultadoDiv.innerHTML = "Erro ao calcular frete. Verifique o CEP ou tente novamente.";
        console.error(error);
      }
    }
  </script>
</body>
</html>
